<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>63.0</apiVersion>
    <assignments>
        <name>Assign_Group_Key</name>
        <label>Assign Group Key</label>
        <locationX>204</locationX>
        <locationY>395</locationY>
        <assignmentItems>
            <assignToReference>$Record.Group_Key__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>f_GroupKey</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Country_Code_Not_Null</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Assign Region from Formula field</description>
        <name>Assign_Region</name>
        <label>Assign Region</label>
        <locationX>50</locationX>
        <locationY>911</locationY>
        <assignmentItems>
            <assignToReference>$Record.Region__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Country_Region.Region__c</elementReference>
            </value>
        </assignmentItems>
    </assignments>
    <decisions>
        <name>Check_Get_Country_Region_Not_null</name>
        <label>Check Get Country Region Not null</label>
        <locationX>182</locationX>
        <locationY>803</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes_1</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Country_Region</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Region</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Country_Code_Not_Null</name>
        <label>Country Code Not Null</label>
        <locationX>336</locationX>
        <locationY>587</locationY>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.BillingCountryCode</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Country_Region</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <decisions>
        <name>Group_Key_Is_Null</name>
        <label>Group Key Is Null</label>
        <locationX>336</locationX>
        <locationY>287</locationY>
        <defaultConnector>
            <targetReference>Country_Code_Not_Null</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Yes1</name>
            <conditionLogic>or</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Group_Key__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>$Record.Group_Key__c</leftValueReference>
                <operator>IsBlank</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Group_Key</targetReference>
            </connector>
            <label>Yes</label>
        </rules>
    </decisions>
    <description>Account : Before Save : Populate Region from Billing Country code
+SS2-T238 : Replace f_Region formula field with Country_Region_Mapping__mdt Logic, stores all Country code and Region in this metadata.</description>
    <environments>Default</environments>
    <formulas>
        <name>f_GroupKey</name>
        <dataType>String</dataType>
        <expression>LEFT({!$Record.Name}, 10)</expression>
    </formulas>
    <formulas>
        <description>Determine Region</description>
        <name>f_region</name>
        <dataType>String</dataType>
        <expression>CASE({!$Record.BillingCountryCode},
&apos;PH&apos;, &apos;ASIA&apos;,
&apos;PK&apos;, &apos;ASIA&apos;,
&apos;PL&apos;, &apos;EMEA&apos;,
&apos;PM&apos;, &apos;EMEA&apos;,
&apos;FJ&apos;, &apos;ASIA&apos;,
&apos;FK&apos;, &apos;AMERICAS&apos;,
&apos;FM&apos;, &apos;ASIA&apos;,
&apos;MC&apos;, &apos;EMEA&apos;,
&apos;MD&apos;, &apos;EMEA&apos;,
&apos;ME&apos;, &apos;EMEA&apos;,
&apos;TT&apos;, &apos;AMERICAS&apos;,
&apos;CK&apos;, &apos;EMEA&apos;,
&apos;IN&apos;, &apos;ASIA&apos;,
&apos;CL&apos;, &apos;AMERICAS&apos;,
&apos;TV&apos;, &apos;ASIA&apos;,
&apos;CM&apos;, &apos;EMEA&apos;,
&apos;IO&apos;, &apos;ASIA&apos;,
&apos;BG&apos;, &apos;EMEA&apos;,
&apos;UM&apos;, &apos;ASIA&apos;,
&apos;JE&apos;, &apos;EMEA&apos;,
&apos;MQ&apos;, &apos;EMEA&apos;,
&apos;IL&apos;, &apos;EMEA&apos;,
&apos;GH&apos;, &apos;EMEA&apos;,
&apos;CF&apos;, &apos;EMEA&apos;,
&apos;TR&apos;, &apos;EMEA&apos;,
&apos;GI&apos;, &apos;EMEA&apos;,
&apos;CG&apos;, &apos;EMEA&apos;,
&apos;IM&apos;, &apos;EMEA&apos;,
&apos;CI&apos;, &apos;EMEA&apos;,
&apos;CH&apos;, &apos;EMEA&apos;,
&apos;AX&apos;, &apos;EMEA&apos;,
&apos;AZ&apos;, &apos;EMEA&apos;,
&apos;BA&apos;, &apos;EMEA&apos;,
&apos;BB&apos;, &apos;AMERICAS&apos;,
&apos;BD&apos;, &apos;ASIA&apos;,
&apos;GL&apos;, &apos;EMEA&apos;,
&apos;GM&apos;, &apos;EMEA&apos;,
&apos;GN&apos;, &apos;EMEA&apos;,
&apos;GP&apos;, &apos;EMEA&apos;,
&apos;GQ&apos;, &apos;EMEA&apos;,
&apos;TW&apos;, &apos;ASIA&apos;,
&apos;AL&apos;, &apos;EMEA&apos;,
&apos;LC&apos;, &apos;AMERICAS&apos;,
&apos;AM&apos;, &apos;EMEA&apos;,
&apos;LI&apos;, &apos;EMEA&apos;,
&apos;AO&apos;, &apos;EMEA&apos;,
&apos;LK&apos;, &apos;ASIA&apos;,
&apos;AQ&apos;, &apos;EMEA&apos;,
&apos;BE&apos;, &apos;EMEA&apos;,
&apos;BF&apos;, &apos;EMEA&apos;,
&apos;GR&apos;, &apos;EMEA&apos;,
&apos;GS&apos;, &apos;AMERICAS&apos;,
&apos;RU&apos;, &apos;EMEA&apos;,
&apos;RW&apos;, &apos;EMEA&apos;,
&apos;SA&apos;, &apos;EMEA&apos;,
&apos;GY&apos;, &apos;AMERICAS&apos;,
&apos;HK&apos;, &apos;ASIA&apos;,
&apos;HM&apos;, &apos;EMEA&apos;,
&apos;AG&apos;, &apos;AMERICAS&apos;,
&apos;HN&apos;, &apos;AMERICAS&apos;,
&apos;AD&apos;, &apos;EMEA&apos;,
&apos;KW&apos;, &apos;EMEA&apos;,
&apos;YE&apos;, &apos;EMEA&apos;,
&apos;AE&apos;, &apos;EMEA&apos;,
&apos;KY&apos;, &apos;AMERICAS&apos;,
&apos;VC&apos;, &apos;AMERICAS&apos;,
&apos;KG&apos;, &apos;EMEA&apos;,
&apos;CX&apos;, &apos;ASIA&apos;,
&apos;CY&apos;, &apos;EMEA&apos;,
&apos;DE&apos;, &apos;EMEA&apos;,
&apos;KI&apos;, &apos;ASIA&apos;,
&apos;VI&apos;, &apos;AMERICAS&apos;,
&apos;KM&apos;, &apos;EMEA&apos;,
&apos;VN&apos;, &apos;ASIA&apos;,
&apos;KN&apos;, &apos;AMERICAS&apos;,
&apos;EE&apos;, &apos;EMEA&apos;,
&apos;EG&apos;, &apos;EMEA&apos;,
&apos;TZ&apos;, &apos;EMEA&apos;,
&apos;IR&apos;, &apos;EMEA&apos;,
&apos;UA&apos;, &apos;EMEA&apos;,
&apos;SS&apos;, &apos;EMEA&apos;,
&apos;ST&apos;, &apos;EMEA&apos;,
&apos;SV&apos;, &apos;AMERICAS&apos;,
&apos;SX&apos;, &apos;EMEA&apos;,
&apos;SY&apos;, &apos;EMEA&apos;,
&apos;SZ&apos;, &apos;EMEA&apos;,
&apos;TC&apos;, &apos;AMERICAS&apos;,
&apos;WF&apos;, &apos;EMEA&apos;,
&apos;KR&apos;, &apos;ASIA&apos;,
&apos;WS&apos;, &apos;ASIA&apos;,
&apos;MX&apos;, &apos;AMERICAS&apos;,
&apos;MY&apos;, &apos;ASIA&apos;,
&apos;MZ&apos;, &apos;EMEA&apos;,
&apos;NA&apos;, &apos;EMEA&apos;,
&apos;CU&apos;, &apos;AMERICAS&apos;,
&apos;CV&apos;, &apos;EMEA&apos;,
&apos;CW&apos;, &apos;EMEA&apos;,
&apos;NP&apos;, &apos;ASIA&apos;,
&apos;NR&apos;, &apos;ASIA&apos;,
&apos;NU&apos;, &apos;ASIA&apos;,
&apos;LR&apos;, &apos;EMEA&apos;,
&apos;LS&apos;, &apos;EMEA&apos;,
&apos;LT&apos;, &apos;EMEA&apos;,
&apos;NG&apos;, &apos;EMEA&apos;,
&apos;NI&apos;, &apos;AMERICAS&apos;,
&apos;NL&apos;, &apos;EMEA&apos;,
&apos;NO&apos;, &apos;EMEA&apos;,
&apos;MU&apos;, &apos;EMEA&apos;,
&apos;MV&apos;, &apos;ASIA&apos;,
&apos;MW&apos;, &apos;EMEA&apos;,
&apos;MF&apos;, &apos;EMEA&apos;,
&apos;TF&apos;, &apos;EMEA&apos;,
&apos;MG&apos;, &apos;EMEA&apos;,
&apos;TG&apos;, &apos;EMEA&apos;,
&apos;MH&apos;, &apos;ASIA&apos;,
&apos;TH&apos;, &apos;ASIA&apos;,
&apos;MK&apos;, &apos;EMEA&apos;,
&apos;TJ&apos;, &apos;EMEA&apos;,
&apos;ML&apos;, &apos;EMEA&apos;,
&apos;TK&apos;, &apos;ASIA&apos;,
&apos;PT&apos;, &apos;EMEA&apos;,
&apos;SM&apos;, &apos;EMEA&apos;,
&apos;PW&apos;, &apos;ASIA&apos;,
&apos;BV&apos;, &apos;EMEA&apos;,
&apos;PY&apos;, &apos;AMERICAS&apos;,
&apos;BW&apos;, &apos;EMEA&apos;,
&apos;QA&apos;, &apos;EMEA&apos;,
&apos;LA&apos;, &apos;ASIA&apos;,
&apos;HR&apos;, &apos;EMEA&apos;,
&apos;ZM&apos;, &apos;EMEA&apos;,
&apos;HT&apos;, &apos;AMERICAS&apos;,
&apos;AI&apos;, &apos;AMERICAS&apos;,
&apos;HU&apos;, &apos;EMEA&apos;,
&apos;LB&apos;, &apos;EMEA&apos;,
&apos;SK&apos;, &apos;EMEA&apos;,
&apos;ZW&apos;, &apos;EMEA&apos;,
&apos;SL&apos;, &apos;EMEA&apos;,
&apos;IS&apos;, &apos;EMEA&apos;,
&apos;UG&apos;, &apos;EMEA&apos;,
&apos;IT&apos;, &apos;EMEA&apos;,
&apos;SB&apos;, &apos;ASIA&apos;,
&apos;SC&apos;, &apos;EMEA&apos;,
&apos;SD&apos;, &apos;EMEA&apos;,
&apos;SE&apos;, &apos;EMEA&apos;,
&apos;EH&apos;, &apos;EMEA&apos;,
&apos;ER&apos;, &apos;EMEA&apos;,
&apos;ES&apos;, &apos;EMEA&apos;,
&apos;ET&apos;, &apos;EMEA&apos;,
&apos;FI&apos;, &apos;EMEA&apos;,
&apos;NZ&apos;, &apos;ASIA&apos;,
&apos;OM&apos;, &apos;EMEA&apos;,
&apos;PA&apos;, &apos;AMERICAS&apos;,
&apos;AR&apos;, &apos;AMERICAS&apos;,
&apos;AS&apos;, &apos;ASIA&apos;,
&apos;SG&apos;, &apos;ASIA&apos;,
&apos;SH&apos;, &apos;EMEA&apos;,
&apos;SI&apos;, &apos;EMEA&apos;,
&apos;DJ&apos;, &apos;EMEA&apos;,
&apos;DK&apos;, &apos;EMEA&apos;,
&apos;DM&apos;, &apos;AMERICAS&apos;,
&apos;NC&apos;, &apos;EMEA&apos;,
&apos;NE&apos;, &apos;EMEA&apos;,
&apos;NF&apos;, &apos;ASIA&apos;,
&apos;IQ&apos;, &apos;EMEA&apos;,
&apos;VE&apos;, &apos;AMERICAS&apos;,
&apos;KH&apos;, &apos;ASIA&apos;,
&apos;VG&apos;, &apos;AMERICAS&apos;,
&apos;DO&apos;, &apos;AMERICAS&apos;,
&apos;DZ&apos;, &apos;EMEA&apos;,
&apos;EC&apos;, &apos;AMERICAS&apos;,
&apos;LU&apos;, &apos;EMEA&apos;,
&apos;LV&apos;, &apos;EMEA&apos;,
&apos;LY&apos;, &apos;EMEA&apos;,
&apos;MA&apos;, &apos;EMEA&apos;,
&apos;PE&apos;, &apos;AMERICAS&apos;,
&apos;PF&apos;, &apos;EMEA&apos;,
&apos;PG&apos;, &apos;ASIA&apos;,
&apos;MM&apos;, &apos;ASIA&apos;,
&apos;TL&apos;, &apos;ASIA&apos;,
&apos;MN&apos;, &apos;ASIA&apos;,
&apos;TM&apos;, &apos;EMEA&apos;,
&apos;MO&apos;, &apos;ASIA&apos;,
&apos;IE&apos;, &apos;EMEA&apos;,
&apos;ID&apos;, &apos;ASIA&apos;,
&apos;MP&apos;, &apos;ASIA&apos;,
&apos;TO&apos;, &apos;ASIA&apos;,
&apos;TN&apos;, &apos;EMEA&apos;,
&apos;BY&apos;, &apos;EMEA&apos;,
&apos;RE&apos;, &apos;EMEA&apos;,
&apos;BZ&apos;, &apos;AMERICAS&apos;,
&apos;RO&apos;, &apos;EMEA&apos;,
&apos;CA&apos;, &apos;AMERICAS&apos;,
&apos;RS&apos;, &apos;EMEA&apos;,
&apos;CC&apos;, &apos;ASIA&apos;,
&apos;GG&apos;, &apos;EMEA&apos;,
&apos;CD&apos;, &apos;EMEA&apos;,
&apos;TD&apos;, &apos;EMEA&apos;,
&apos;JM&apos;, &apos;AMERICAS&apos;,
&apos;UY&apos;, &apos;AMERICAS&apos;,
&apos;JO&apos;, &apos;EMEA&apos;,
&apos;UZ&apos;, &apos;EMEA&apos;,
&apos;JP&apos;, &apos;ASIA&apos;,
&apos;VA&apos;, &apos;EMEA&apos;,
&apos;KE&apos;, &apos;EMEA&apos;,
&apos;CN&apos;, &apos;ASIA&apos;,
&apos;CO&apos;, &apos;AMERICAS&apos;,
&apos;CR&apos;, &apos;AMERICAS&apos;,
&apos;GT&apos;, &apos;AMERICAS&apos;,
&apos;GU&apos;, &apos;ASIA&apos;,
&apos;GW&apos;, &apos;EMEA&apos;,
&apos;YT&apos;, &apos;EMEA&apos;,
&apos;AF&apos;, &apos;EMEA&apos;,
&apos;KZ&apos;, &apos;EMEA&apos;,
&apos;ZA&apos;, &apos;EMEA&apos;,
&apos;AT&apos;, &apos;EMEA&apos;,
&apos;AU&apos;, &apos;ASIA&apos;,
&apos;AW&apos;, &apos;AMERICAS&apos;,
&apos;GB&apos;, &apos;EMEA&apos;,
&apos;GD&apos;, &apos;AMERICAS&apos;,
&apos;GE&apos;, &apos;EMEA&apos;,
&apos;GF&apos;, &apos;EMEA&apos;,
&apos;PN&apos;, &apos;ASIA&apos;,
&apos;PR&apos;, &apos;AMERICAS&apos;,
&apos;PS&apos;, &apos;EMEA&apos;,
&apos;BM&apos;, &apos;AMERICAS&apos;,
&apos;BN&apos;, &apos;ASIA&apos;,
&apos;BO&apos;, &apos;AMERICAS&apos;,
&apos;MR&apos;, &apos;EMEA&apos;,
&apos;MS&apos;, &apos;AMERICAS&apos;,
&apos;MT&apos;, &apos;EMEA&apos;,
&apos;BH&apos;, &apos;EMEA&apos;,
&apos;BI&apos;, &apos;EMEA&apos;,
&apos;BJ&apos;, &apos;EMEA&apos;,
&apos;BL&apos;, &apos;EMEA&apos;,
&apos;FO&apos;, &apos;EMEA&apos;,
&apos;FR&apos;, &apos;EMEA&apos;,
&apos;GA&apos;, &apos;EMEA&apos;,
&apos;&apos;					)</expression>
    </formulas>
    <interviewLabel>Account : Before Save : Populate Region {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Account : Before Save : Populate Region</label>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_Country_Region</name>
        <label>Get Country Region</label>
        <locationX>182</locationX>
        <locationY>695</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Check_Get_Country_Region_Not_null</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Country_Code__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.BillingCountryCode</elementReference>
            </value>
        </filters>
        <filters>
            <field>Region__c</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Country_Region_Mapping__mdt</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <start>
        <locationX>210</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Group_Key_Is_Null</targetReference>
        </connector>
        <filterLogic>( 1 AND 3 ) OR 2</filterLogic>
        <filters>
            <field>BillingCountryCode</field>
            <operator>IsChanged</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Id</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>BillingCountryCode</field>
            <operator>IsNull</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </filters>
        <object>Account</object>
        <recordTriggerType>CreateAndUpdate</recordTriggerType>
        <triggerType>RecordBeforeSave</triggerType>
    </start>
    <status>Active</status>
</Flow>
